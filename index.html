<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Lithium : Error monitoring" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Lithium</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/freshout-dev/lithium">View on GitHub</a>

          <h1 id="project_title">Lithium</h1>
          <h2 id="project_tagline">Error monitoring</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/freshout-dev/lithium/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/freshout-dev/lithium/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="lithium---error-monitoring-for-neon" class="anchor" href="#lithium---error-monitoring-for-neon"><span class="octicon octicon-link"></span></a>Lithium - Error monitoring for Neon</h1>

<p>Lithium is a Code monitoring tool for Neon. Its main use case is to detect execution events on the JavaScript code such as Errors.</p>

<p>It monitors the code at the execution level, so it can be used on live code to detect errors, and notify about this errors to another library or the console.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Lithium depends on a patched version of neon, (provided on this repo).</p>

<div class="highlight highlight-js"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"./neon.js"</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"./neon.li_patch.js"</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"./lithium.js"</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>

<span class="c1">// place other neon based files here."</span>
</pre></div>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Lithium exposes a set of Engines for the execution phases of code.</p>

<ul>
<li>Before execution: This is triggered before the execution of a function.</li>
<li>Error detection: This is triggered in the case that a function dispatched an error.</li>
<li>After execution: This is triggered after the function returned the execution control.</li>
</ul><p>All of the engines act as a list of functions that will be executed in the order they were added to the engine pool.</p>

<p>Note that code that was not called by a Lithium monitored code will not detect errors because its not possible to do so. Errors trapped and handled by
your code will not be detected either (this is a JavaScript behavior).</p>

<p>The internal data structure of this engines is a plain Array object so you can modify its values with the vanilla Array methods from JavaScript.</p>

<p>On this example we are going to focus on the Error engine.</p>

<div class="highlight highlight-js"><pre><span class="cm">/*</span>
<span class="cm">data object contents.</span>
<span class="cm">data = {</span>
<span class="cm">    scope : &lt;&lt;Object&gt;&gt;, //The object where the error was detected</span>
<span class="cm">    args : &lt;&lt;Array&gt;&gt;, //The arguments that the function received</span>
<span class="cm">    spy : &lt;&lt;Object&gt;&gt;, //The reference to the Lithium Object monitoring this function</span>
<span class="cm">    error : &lt;&lt;Error&gt;&gt; //The internal JavaScript Error object</span>
<span class="cm">}</span>
<span class="cm">*/</span>

<span class="nx">Li</span><span class="p">.</span><span class="nx">Engine</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>

</pre></div>

<h2>
<a name="advanced-usage" class="anchor" href="#advanced-usage"><span class="octicon octicon-link"></span></a>Advanced Usage</h2>

<p>On this example we are going to get more information out of the error notification on the Error Engine.</p>

<p>We are going to focus on the spy properties.</p>

<div class="highlight highlight-js"><pre><span class="nx">spy</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">targetObject</span> <span class="o">:</span> <span class="o">&lt;&lt;</span><span class="nb">Object</span><span class="o">&gt;&gt;</span><span class="p">,</span> <span class="c1">//The object that holds the function</span>
    <span class="nx">methodName</span> <span class="o">:</span> <span class="o">&lt;&lt;</span><span class="nb">String</span><span class="o">&gt;&gt;</span><span class="p">,</span> <span class="c1">//The property name where the function lives</span>
    <span class="nx">originalMethod</span> <span class="o">:</span> <span class="o">&lt;&lt;</span><span class="nb">Function</span><span class="o">&gt;&gt;</span><span class="p">,</span> <span class="c1">//The original method of the object</span>
    <span class="nx">objectHasMethod</span> <span class="o">:</span> <span class="o">&lt;&lt;</span><span class="nb">Boolean</span><span class="o">&gt;&gt;</span> <span class="c1">//Tells if the method actually lives on the object or lives on the prototype chain</span>
<span class="p">}</span>

<span class="nx">Li</span><span class="p">.</span><span class="nx">Engine</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">errorData</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'Lithium Detected an Error on '</span><span class="p">,</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">className</span><span class="p">,</span>
        <span class="s1">' on method  '</span><span class="p">,</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">spy</span><span class="p">.</span><span class="nx">methodName</span><span class="p">,</span>
        <span class="s1">' with message  '</span><span class="p">,</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
    <span class="p">];</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">errorDatai</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">' '</span><span class="p">));</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">stack</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="enabling-or-disabling-lithium" class="anchor" href="#enabling-or-disabling-lithium"><span class="octicon octicon-link"></span></a>Enabling or Disabling Lithium</h2>

<p>Lithium is enabled by default but there are cases where you don't want this.</p>

<p>The first strategy to fully disable it is by running this code after Lithium inclussion.</p>

<div class="highlight highlight-js"><pre><span class="nx">enableLi</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>

<p>If you want to remove Lithium on runtime from a specific object.</p>

<div class="highlight highlight-js"><pre><span class="nx">object</span><span class="p">.</span><span class="nx">otherObject</span><span class="p">.</span><span class="nx">__objectSpy</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>

<h2>
<a name="final-notes" class="anchor" href="#final-notes"><span class="octicon octicon-link"></span></a>Final notes</h2>

<p>Lithium does not require interaction with its code. So there are no methods that you have to run or any instance that you have to create
all its handled by itself.</p>

<p>You dont need to code for lithium, it will monitor if you ask it to do so.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Lithium maintained by <a href="https://github.com/freshout-dev">freshout-dev</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
